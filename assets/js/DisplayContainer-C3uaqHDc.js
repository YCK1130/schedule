const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/CalendarHeader-PYtp7ul8.js","assets/js/bootstrap-ui-CpibWHK_.js","assets/js/react-vendor-C7tYskqo.js","assets/js/index-74dCG_Iq.js","assets/js/scheduler-algos-DzC9Ax8u.js","assets/js/utils-DJ2i655f.js","assets/js/xlsx-DgL3v4p1.js","assets/js/vendor-utils-B86ZpiIR.js","assets/css/index-BBD9AhwG.css","assets/js/CalendarGrid-DTxskkjO.js","assets/js/CalendarLegend-Dyv5Gwgs.js"])))=>i.map(i=>d[i]);
import{j as e,B as s,a as i,r as n,C as r,D as t,M as l,F as a,A as c,T as d,R as h,b as x,c as j}from"./bootstrap-ui-CpibWHK_.js";import{u as o,_ as m,__tla as __tla_0}from"./index-74dCG_Iq.js";import{f as v,b as w,e as g,d as p}from"./utils-DJ2i655f.js";import"./react-vendor-C7tYskqo.js";import"./scheduler-algos-DzC9Ax8u.js";import"./xlsx-DgL3v4p1.js";import"./vendor-utils-B86ZpiIR.js";let _;let __tla=Promise.all([(()=>{try{return __tla_0}catch{}})()]).then(async()=>{let y,u,b,N,C,k;y=n.lazy(()=>m(()=>import("./CalendarHeader-PYtp7ul8.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])));u=n.lazy(()=>m(()=>import("./CalendarGrid-DTxskkjO.js"),__vite__mapDeps([9,1,2,3,4,5,6,7,8])));b=n.lazy(()=>m(()=>import("./CalendarLegend-Dyv5Gwgs.js"),__vite__mapDeps([10,1,2])));N=()=>e.jsxs("div",{className:"loading-container",style:{gridColumn:"1 / -1",height:"200px"},children:[e.jsx("div",{className:"spinner"}),e.jsx("h3",{className:"loading-text",children:"日曆載入中..."})]});C=()=>{const{scheduledInterviews:r,unmatchedResults:t,viewMode:l,loading:a,setViewMode:c}=o();return e.jsxs("div",{className:"calendar-container",children:[e.jsxs("div",{className:"calendar-header-section d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"m-0",children:r.length>0?"面試時間表":"可用時段總覽"}),r.length>0&&t&&t.interviewees.length>0&&e.jsxs(s,{size:"sm",children:[e.jsx(i,{variant:"scheduled"===l?"primary":"outline-primary",onClick:()=>c("scheduled"),children:"已排程"}),e.jsxs(i,{variant:"unmatched"===l?"primary":"outline-primary",onClick:()=>c("unmatched"),children:["未排程 (",t.interviewees.length,")"]})]})]}),e.jsx("div",{className:"calendar-main",children:e.jsx("div",{className:"calendar-view",children:e.jsx("div",{className:"calendar-scroll-container "+(a?"no-scroll":""),children:e.jsxs(n.Suspense,{fallback:e.jsx(N,{}),children:[e.jsx(y,{}),e.jsx(u,{})]})})})}),e.jsx("div",{className:"calendar-footer",children:e.jsx(n.Suspense,{fallback:e.jsx("div",{className:"p-2",children:"載入中..."}),children:e.jsx(b,{isScheduleView:"scheduled"===l&&r.length>0})})})]})};k=()=>{const{interviewers:s,interviewees:j,scheduledInterviews:m,unmatchedResults:y}=o(),[u,b]=n.useState(!1),[N,C]=n.useState(!1),[k,_]=n.useState({interviews:!0,interviewers:!0,interviewers_stats:!0,interviewees:!0}),f=e=>{p(e,m,s,j),C(!1)},A=e=>{_({...k,[e]:!k[e]})};return e.jsxs(e.Fragment,{children:[e.jsxs(r,{className:"mb-4",children:[e.jsxs(r.Header,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h5",{className:"mb-0",children:["已安排面試 (",m.length,")"]}),m.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(t,{children:[e.jsx(t.Toggle,{variant:"primary",size:"sm",id:"dropdown-export",children:"匯出數據"}),e.jsxs(t.Menu,{children:[e.jsx(t.Item,{onClick:()=>C(!0),children:"匯出 CSV 檔案"}),e.jsx(t.Item,{onClick:()=>b(!0),children:"匯出 Excel 檔案"})]})]}),e.jsxs(l,{show:u,onHide:()=>b(!1),children:[e.jsx(l.Header,{closeButton:!0,children:e.jsx(l.Title,{children:"選擇匯出 Excel 選項"})}),e.jsx(l.Body,{children:e.jsxs(a,{children:[e.jsx(a.Check,{type:"checkbox",id:"interviews",label:"面試場次安排表",checked:k.interviews,onChange:()=>A("interviews"),className:"mb-2"}),e.jsx(a.Check,{type:"checkbox",id:"interviewers",label:"面試官各場次安排",checked:k.interviewers,onChange:()=>A("interviewers"),className:"mb-2"}),e.jsx(a.Check,{type:"checkbox",id:"interviewers_stats",label:"面試官場次統計",checked:k.interviewers_stats,onChange:()=>A("interviewers_stats"),className:"mb-2"}),e.jsx(a.Check,{type:"checkbox",id:"interviewees",label:"應試者面試安排",checked:k.interviewees,onChange:()=>A("interviewees"),className:"mb-2"})]})}),e.jsxs(l.Footer,{children:[e.jsx(i,{variant:"secondary",onClick:()=>b(!1),children:"取消"}),e.jsx(i,{variant:"primary",onClick:()=>{const e=Object.entries(k).filter(([,e])=>e).map(([e])=>e);0!==e.length&&(g(e,m,s,j),b(!1))},children:"匯出"})]})]}),e.jsxs(l,{show:N,onHide:()=>C(!1),children:[e.jsx(l.Header,{closeButton:!0,children:e.jsx(l.Title,{children:"選擇匯出 CSV 選項"})}),e.jsx(l.Body,{children:e.jsxs("div",{className:"d-grid gap-2",children:[e.jsx(i,{variant:"outline-primary",className:"text-start",onClick:()=>f("interviews"),children:"面試場次安排表"}),e.jsx(i,{variant:"outline-primary",className:"text-start",onClick:()=>f("interviewers"),children:"面試官各場次安排"}),e.jsx(i,{variant:"outline-primary",className:"text-start",onClick:()=>f("interviewers_stats"),children:"面試官場次統計"}),e.jsx(i,{variant:"outline-primary",className:"text-start",onClick:()=>f("interviewees"),children:"應試者面試安排"})]})}),e.jsx(l.Footer,{children:e.jsx(i,{variant:"secondary",onClick:()=>C(!1),children:"取消"})})]})]})]}),e.jsx(r.Body,{children:0===m.length?e.jsx(c,{variant:"info",children:"尚未安排任何面試。"}):e.jsxs(d,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"center",width:"3.5em",textWrap:"balance"},children:"編號"}),e.jsx("th",{style:{textAlign:"center",width:"3.5em"},children:"日期"}),e.jsx("th",{style:{textAlign:"center",width:"8em"},children:"時間"}),e.jsx("th",{style:{textAlign:"center"},children:"面試者"}),e.jsx("th",{style:{textAlign:"center"},children:"面試官"})]})}),e.jsx("tbody",{children:m.map(s=>e.jsxs("tr",{children:[e.jsx("td",{style:{textAlign:"center",width:"3.5em"},children:s.id}),e.jsx("td",{style:{textAlign:"center",width:"3.5em"},children:v(s.startTime,s.endTime).date}),e.jsx("td",{style:{textAlign:"center",width:"8em"},children:v(s.startTime,s.endTime).time}),e.jsx("td",{children:s.interviewees.map(e=>e.name).join(", ")}),e.jsx("td",{children:s.interviewers.map(e=>e.name).join(", ")})]},`${s.interviewees[0].id}-${s.startTime}`))})]})})]}),y&&(y.interviewers.length>0||y.interviewees.length>0)&&e.jsxs(r,{className:"mb-4",border:"danger",children:[e.jsx(r.Header,{className:"bg-danger text-white",children:e.jsx("h5",{className:"mb-0",children:"未配對名單"})}),e.jsx(r.Body,{children:e.jsx(h,{children:e.jsx(x,{children:y.interviewees.length>0&&e.jsxs("div",{children:[e.jsx("h6",{className:"text-danger",children:"未配對面試者："}),e.jsxs(d,{striped:!0,bordered:!0,hover:!0,size:"sm",className:"border-danger",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"10%",textAlign:"center"},children:"姓名"}),e.jsx("th",{children:"可面試時間"})]})}),e.jsx("tbody",{children:y.interviewees.map(s=>e.jsxs("tr",{className:"text-danger",children:[e.jsx("td",{style:{width:"10%",textAlign:"center"},children:s.name}),e.jsx("td",{children:w(s)})]},s.id))})]})]})})})})]})]})};_=()=>e.jsxs(j,{className:"py-2",children:[e.jsx(h,{className:"fix-width-container",children:e.jsx(x,{children:e.jsx(C,{})})}),e.jsx(h,{className:"fix-width-container",children:e.jsx(x,{children:e.jsx(k,{})})})]})});export{_ as default,__tla};