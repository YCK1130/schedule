import{j as e,r as i,O as s,d as t}from"./bootstrap-ui-CpibWHK_.js";import{u as r}from"./index-74dCG_Iq.js";import{k as a,m as n,n as l,o as d,q as o}from"./utils-DJ2i655f.js";import"./react-vendor-C7tYskqo.js";import"./scheduler-algos-DzC9Ax8u.js";import"./xlsx-DgL3v4p1.js";import"./vendor-utils-B86ZpiIR.js";const c=({availability:i})=>{const{interviewersNum:s,intervieweesNum:t}=i;return e.jsx("div",{className:"calendar-time-slot",children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px",justifyContent:"start",width:"100%"},children:[s>0&&e.jsxs("div",{style:{color:"#4E6688"},children:["面試官: ",s]}),t>0&&e.jsxs("div",{style:{color:"#DDA853"},children:["應試者: ",t]})]})})},m=({availability:i})=>{const{interview:s}=i;if(!s||0===s.length)return null;const t=`ScheduleTimeSlot-${s[0].startTime}-${s[0].endTime}`;return e.jsx("div",{className:"calendar-time-slot "+(s[0].isStart?"pt-2":s[0].isEnd?"pb-2":""),children:s.map(i=>{let s=null;return i.isStart?s={borderRadius:"2px 2px 0 0"}:i.isEnd&&(s={borderRadius:"0 0 2px 2px"}),s={...s,backgroundColor:`${i.color}`},e.jsx("div",{className:"interview-block mx-2",style:s},`${t}-interview-block-${i.colorIndex}-${i.color}`)})},`${t}-calendar-time-slot`)},v=({availability:i,showSchedule:s=!1})=>e.jsx(e.Fragment,{children:s?e.jsx(m,{availability:i}):e.jsx(c,{availability:i})}),h=()=>{const{unmatchedResults:c,viewMode:m,displayInfo:{startDate:h,daysToShow:p,earliestTime:u,latestTime:x},getSlotData:j,scheduledInterviews:w,loading:N}=r(),$=i.useMemo(()=>a(w),[w]),g=i.useMemo(()=>n(u,x),[u,x]),y=(e,i)=>{const[s,t]=i.split(":"),r=parseInt(s,10),a=parseInt(t,10),n=j(e,r,a);if(!n)return{interviewersNum:0,intervieweesNum:0,interviewersNames:"",intervieweesNames:""};const{availableInterviewers:l,availableInterviewees:o,scheduledInterviews:v}=n;let h=l,p=o;if("unmatched"===m&&c){const e=new Set(c.interviewers.map(e=>e.id)),i=new Set(c.interviewees.map(e=>e.id));h=l.filter(i=>e.has(i.id)),p=o.filter(e=>i.has(e.id))}if("scheduled"===m&&v&&v.length>0){return{interview:d(e,i,v,$),interviewersNum:0,intervieweesNum:0,interviewersNames:"",intervieweesNames:""}}return{interviewersNum:h.length,intervieweesNum:p.length,interviewersNames:h.map(e=>`${e.name} (${e.position?.charAt(0)||"N/A"})`).join(", "),intervieweesNames:p.map(e=>`${e.name} (${e.position?.charAt(0)||"N/A"})`).join(", ")}},f=(i,s)=>{const[r,a]=s.split(":"),n=parseInt(r,10),l=parseInt(a,10),d=j(i,n,l);let{scheduledInterviews:c}=d||{scheduledInterviews:[]};c||(c=[]);const v=o(i,s,c,$);return"scheduled"===m&&c.length>=0&&0===v.length?e.jsx(t,{children:e.jsx("div",{style:{display:"none"}},`${i}-tooltip`)}):e.jsx(t,{className:"availability-tooltip",children:e.jsx("div",{className:"tooltip-content",children:"scheduled"===m&&c.length>0?v.map(i=>e.jsx("div",{className:"interview-details",children:e.jsxs("div",{className:"interview-slot",style:{borderLeft:`3px solid ${i.color}`,margin:"8px 0",padding:"8px",color:"#000"},children:[e.jsxs("span",{className:"interview-time",children:["面試編號：",i.id]}),e.jsx("div",{className:"interview-details",children:e.jsxs("p",{children:[e.jsx("strong",{children:"面試官："}),i.interviewers.map(e=>`${e.name} (${e.position?.charAt(0)||"N/A"})`).join(", ")]})},`${i.interviewees.map(e=>e.id)[0]}-${i.startTime}-interview-details`),e.jsx("div",{className:"interview-details",children:e.jsxs("p",{children:[e.jsx("strong",{children:"應試者："}),i.interviewees.map(e=>`${e.name} (${e.position?.charAt(0)||"N/A"})`).join(", ")]})})]},`${i.interviewees[0].id}-${i.startTime}-interview-slot`)},`${i.interviewees[0].id}-${i.startTime}-interview-details`)):e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"面試官："})," ",y(i,s).interviewersNames||"無"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"應試者："})," ",y(i,s).intervieweesNames||"無"]})]},`${i}-tooltip`)})})};return i.useLayoutEffect(()=>{document.documentElement.style.setProperty("--calendar-grid-num",`${p}`)},[p]),e.jsxs("div",{className:"calendar-grid",children:[e.jsx("div",{className:"time-column",children:g.filter((e,i)=>i%2==0).map(i=>e.jsx("div",{className:"time-header",children:i},`header-${i}`))}),N?e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"spinner"}),e.jsx("h3",{className:"loading-text",children:"資料預處理中..."})]}):l(h,p).map((i,t)=>e.jsx("div",{className:"day-column",children:g.map((r,a)=>{let n=r;const l="scheduled"===m&&w.length>0;r.endsWith(":30")&&!l&&(n=n.replace(":30",":00"));const d=y(i,l?r:n);return e.jsx(s,{placement:"auto",delay:{show:50,hide:100},overlay:f(i,n),children:e.jsx("div",{className:"time-slot-wrapper",children:e.jsx(v,{availability:d,showSchedule:l})},`slot-${t}-${a}`)},`overlay-${t}-${a}`)})},`column-${t}`))]})};export{h as default};
